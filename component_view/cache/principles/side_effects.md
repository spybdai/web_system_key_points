#### 缓存的副作用

- 源数据和缓存数据不一致

  在缓存数据为其他存储数据拷贝的场景下，缓存本质上是数据冗余的一种形式(将数据冗余在速度相对更快的存储介质)。因此数据冗余导致的数据不一致的问题，也存在于缓存的场景。

- stateful

  缓存的数据本质上是程序(进程)运行过程中的“结果”，代表程序的某种状态。

  因此，在约定stateless service(stateful service也有其适用的场景)的设计前提下, 缓存使用如果不恰当，导致程序(服务)的伸缩性(scalability)降低。比如，进程内缓存，会增加多程序(服务)实例(无论服务是同一主机还是跨主机上)部署的成本。主机内缓存，会增加多程序(服务)实例跨主机部署的成本。

  为保证伸缩性，一个常用的做法是， 采用与程序运行“伸缩范围”对应粒度的缓存。比如，

  - 确定程序只会在单进程运行，进程内缓存就够了。
  - 于进程的，位于同一主机内的缓存服务。
  - 如果程序需要跨主机部署，则需要独立于主机的，对多主机上的程序均可见的缓存服务。

  在当前web系统，通常会追求程序的最大伸缩能力。

